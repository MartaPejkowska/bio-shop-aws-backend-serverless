{"version":3,"file":"lambdas/createProduct.js","mappings":"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","sources":["webpack://Bio_shop_backend/webpack/bootstrap","webpack://Bio_shop_backend/webpack/runtime/define property getters","webpack://Bio_shop_backend/webpack/runtime/hasOwnProperty shorthand","webpack://Bio_shop_backend/webpack/runtime/make namespace object","webpack://Bio_shop_backend/external commonjs \"@aws-sdk/lib-dynamodb\"","webpack://Bio_shop_backend/external commonjs \"@aws-sdk/client-dynamodb\"","webpack://Bio_shop_backend/./lambdas/responses.js","webpack://Bio_shop_backend/external commonjs \"uuid\"","webpack://Bio_shop_backend/external commonjs \"joi\"","webpack://Bio_shop_backend/./lambdas/createProduct.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@aws-sdk/lib-dynamodb\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@aws-sdk/client-dynamodb\");","export const responses={\r\n    _200(data={}){\r\n        return{\r\n            headers:{\r\n                'Content-Type':'application/json',\r\n                'Access-Control-Allow-Methods':'*',\r\n                'Access-Control-Allow-Origin':'*',\r\n            },\r\n            statusCode:200,\r\n            body:JSON.stringify(data)\r\n        }\r\n    },\r\n    _400(data={}){\r\n        return{\r\n            headers:{\r\n                'Content-Type':'application/json',\r\n                'Access-Control-Allow-Methods':'*',\r\n                'Access-Control-Allow-Origin':'*',\r\n            },\r\n            statusCode:400,\r\n            body:JSON.stringify(data)\r\n        }\r\n    },\r\n    _500(data={}){\r\n        return{\r\n            headers:{\r\n                'Content-Type':'application/json',\r\n                'Access-Control-Allow-Methods':'*',\r\n                'Access-Control-Allow-Origin':'*',\r\n            },\r\n            statusCode:400,\r\n            body:JSON.stringify(data)\r\n        }\r\n    },\r\n}\r\n\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"uuid\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"joi\");","import { DynamoDBDocument } from \"@aws-sdk/lib-dynamodb\";\r\nimport { DynamoDB } from \"@aws-sdk/client-dynamodb\";\r\nimport {responses} from './responses.js';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport * as Joi from 'joi';\r\n\r\nconst dynamo= DynamoDBDocument.from(new DynamoDB());\r\nconst TableName=process.env.TableName\r\nconst StockTable=process.env.StockTableName\r\n\r\nconst schema=Joi.object({\r\n    title:Joi.string().min(3).required(),\r\n    description:Joi.string(),\r\n    price:Joi.number().required(),\r\n    image:Joi.string(),\r\n    packSize:Joi.string(),\r\n    id:Joi.string().guid()\r\n})\r\n\r\nexport const createProduct= async event=>{\r\n\r\n    console.log(event)\r\n    const product= event.body ? JSON.parse(event.body) : JSON.parse(event)\r\n    console.log(product)\r\n    let id=uuidv4();\r\n    product.id=id\r\n\r\n    const stock={\r\n    product_id:id,\r\n    count:Math.floor(Math.random()*100)\r\n}\r\n\r\n    const result = schema.validate(product)\r\n    const isValid=result.error\r\n\r\n     if (isValid=== undefined || null) {\r\n     const newProduct = await dynamo.put({TableName:TableName, Item:product})\r\n    .catch(err=> console.log(err))\r\n    .then(dynamo.put({TableName:StockTable, Item: stock}))\r\n    .catch(err=> console.log(err))\r\n\r\n    const finalProduct=Object.assign(product, product.count=stock.count)\r\n    const succesMessage=['Product added to Product and Stock database  ', finalProduct]\r\n    // return responses._200(Object.assign(product, product.count=stock.count))\r\n    console.log(succesMessage)\r\n    return responses._200(succesMessage)\r\n    }\r\n    else\r\n    {const failMessage='Invalid data   '+ result.error.details.map(detail =>  detail.message)\r\n    console.log(failMessage)\r\n    // return responses._400(result.error.details.map(detail =>  detail.message))\r\n    return responses._400(failMessage)\r\n}\r\n\r\n}"],"names":["responses","_200","data","headers","statusCode","body","JSON","stringify","_400","_500","DynamoDBDocument","DynamoDB","v4","uuidv4","Joi","dynamo","from","TableName","process","env","StockTable","StockTableName","schema","object","title","string","min","required","description","price","number","image","packSize","id","guid","createProduct","event","console","log","product","parse","stock","product_id","count","Math","floor","random","result","validate","isValid","error","undefined","newProduct","put","Item","catch","err","then","finalProduct","Object","assign","succesMessage","failMessage","details","map","detail","message"],"sourceRoot":""}